roster$grade[score<y[4]]="F"
})
name=strsplit((roster$Student)," ")
lastName=sapply(name,"[",2)
firstName=sapply(name,"[",1)
roster=cbind(roster[,-1],lastName,firstName)# 有了详细的姓名 不用student  列了
roster=roster[order(firstName,lastName),]
roster
roster
options(digit=2)#  数字全部用两位小数表示
Student=c("J S","A W","B M","D J","J M","C C","R Y","G K","J E","M R")
Math=c(502,600,412,358,495,512,410,625,573,522)
Science=c(95,99,80,82,75,85,80,95,89,86)
English=c(25,22,18,15,20,28,15,30,27,18)
roster=data.frame(Student,Math,Science,English,stringsAsFactors = FALSE)
roster
z=scale(roster[,2:4])
score=apply(z,1,mean)
roster=cbind(roster,score)
y=quantile(score,c(.8,.6,.4,.2))
roster=within(roster,{
roster$grade[score>=y[1]]="A"
roster$grade[score<y[1]&score>=y[2]]="B"
roster$grade[score<y[2]&score>=y[3]]="C"
roster$grade[score<y[3]&score>=y[4]]="D"
roster$grade[score<y[4]]="F"
})
name=strsplit((roster$Student)," ")
lastName=sapply(name,"[",2)
firstName=sapply(name,"[",1)
#roster=cbind(roster[,-1],lastName,firstName)# 有了详细的姓名 不用student  列了
roster=roster[order(firstName,lastName),]
roster
options(digit=2)#  数字全部用两位小数表示
Student=c("J S","A W","B M","D J","J M","C C","R Y","G K","J E","M R")
Math=c(502,600,412,358,495,512,410,625,573,522)
Science=c(95,99,80,82,75,85,80,95,89,86)
English=c(25,22,18,15,20,28,15,30,27,18)
roster=data.frame(Student,Math,Science,English,stringsAsFactors = FALSE)
roster
z=scale(roster[,2:4])
score=apply(z,1,mean)
roster=cbind(roster,score)
roster
y=quantile(score,c(.8,.6,.4,.2))
roster=within(roster,{
roster$grade[score>=y[1]]="A"
roster$grade[score<y[1]&score>=y[2]]="B"
roster$grade[score<y[2]&score>=y[3]]="C"
roster$grade[score<y[3]&score>=y[4]]="D"
roster$grade[score<y[4]]="F"
})
name=strsplit((roster$Student)," ")
lastName=sapply(name,"[",2)
firstName=sapply(name,"[",1)
roster=cbind(lastName,firstName,roster[,-1])# 有了详细的姓名 不用student  列了
roster=roster[order(firstName,lastName),]
roster
options(digit=2)#  数字全部用两位小数表示
Student=c("J S","A W","B M","D J","J M","C C","R Y","G K","J E","M R")
Math=c(502,600,412,358,495,512,410,625,573,522)
Science=c(95,99,80,82,75,85,80,95,89,86)
English=c(25,22,18,15,20,28,15,30,27,18)
roster=data.frame(Student,Math,Science,English,stringsAsFactors = FALSE)
roster
z=scale(roster[,2:4])
score=apply(z,1,mean)
roster=cbind(roster,score)
y=quantile(score,c(.8,.6,.4,.2))
roster=within(roster,{
roster$grade[score>=y[1]]="A"
roster$grade[score<y[1]&score>=y[2]]="B"
roster$grade[score<y[2]&score>=y[3]]="C"
roster$grade[score<y[3]&score>=y[4]]="D"
roster$grade[score<y[4]]="F"
})
name=strsplit((roster$Student)," ")
lastName=sapply(name,"[",2)
firstName=sapply(name,"[",1)
roster
options(digit=2)#  数字全部用两位小数表示
Student=c("J S","A W","B M","D J","J M","C C","R Y","G K","J E","M R")
Math=c(502,600,412,358,495,512,410,625,573,522)
Science=c(95,99,80,82,75,85,80,95,89,86)
English=c(25,22,18,15,20,28,15,30,27,18)
roster=data.frame(Student,Math,Science,English,stringsAsFactors = FALSE)
roster
z=scale(roster[,2:4])
score=apply(z,1,mean)
roster=cbind(roster,score)
roster
y=quantile(score,c(.8,.6,.4,.2))
roster=within(roster,{
roster$grade[score>=y[1]]="A"
roster$grade[score<y[1]&score>=y[2]]="B"
roster$grade[score<y[2]&score>=y[3]]="C"
roster$grade[score<y[3]&score>=y[4]]="D"
roster$grade[score<y[4]]="F"
})
roster
name=strsplit((roster$Student)," ")
lastName=sapply(name,"[",2)
firstName=sapply(name,"[",1)
roster
roster=cbind(firstName,lastName,roster[,-1])# 有了详细的姓名 不用student  列了
roster=roster[order(firstName,lastName),]
roster
mdf=merge(trail_data$price,dfp)
draw(mdf)
dfp=predict(step_lm_model,interval = "prediction")
head(dfp,10)
dfp=predict(step_lm_model,interval = "prediction")
library(ggplot2)
#dataset 名称由   diamond 改为 diamonds
head(diamonds)
sample_data=sample(2,nrow(diamonds),replace = TRUE,prob=c(0.7,0.3))
trail_data=diamonds[sample_data==1,] #训练数据
test_data=diamonds[sample_data==2,]
lm_model=lm(price~., data=trail_data)
summary(lm_model)
par(mfrow=c(2,2))
plot(lm_model)
summary(lm_model)
par(mfrow=c(2,2))
plot(lm_model)
step_lm_model=step(lm_model)
summary(step_lm_model)
dfp=predict(step_lm_model,interval = "prediction")
head(dfp,10)
mdf=merge(trail_data$price,dfp)
draw(mdf)
library(rpart)
tree_model=rpart(price~.,data=trail_data)
print(tree_model)
install.packages("maptree")
library(maptree)
#draw the tree
draw.tree(tree_model)
rsq.rpart(tree_model)
plotcp(tree_model)
plotcp(tree_model)
tree_model2=prune(tree_model,cp=0.1)
dfp2=predict(tree_model2,interval = "prediction")
head(dfp2,10)
mdf2=merge(trail_data$price,dfp2)
draw(mdf2)
？draw
?draw
??draw
mdf=merge(trail_data$price,dfp)
draw(mdf)
memory.limit()
memory.limit(102400)
memory.limit()
memory.size()
memory.size(102400)
memory.size()
dfp=predict(step_lm_model,interval = "prediction")
dfp
mdf=merge(trail_data$price,dfp
mdf=merge(trail_data$price,dfp)
mdf=merge(trail_data$price,dfp)
pairs(as.data.frame(trail_data[,c(-2,-3,-4)]))
pairs(as.data.frame(trail_data[,c(-2,-3,-4)]))
library(rpart)
tree_model=rpart(price~.,data=trail_data)
print(tree_model)
install.packages("maptree")
library(maptree)
#draw the tree
draw.tree(tree_model)
install.packages("maptree")
rsq.rpart(tree_model)
rsq.rpart(tree_model)
plotcp(tree_model)
tree_model2=prune(tree_model,cp=0.1)
library(rpart)
tree_model=rpart(price~.,data=trail_data)
print(tree_model)
install.packages("maptree")
library(maptree)
draw.tree(tree_model)
rsq.rpart(tree_model)
plotcp(tree_model)
tree_model2=prune(tree_model,cp=0.1)
dfp2=predict(tree_model2,interval = "prediction")
head(dfp2,10)
head(dfp2,1000)
draw(mdf2)
dfp=predict(step_lm_model,interval = "prediction")
head(dfp,10)
View(dfp)
library(ggplot2)
library(car)
head(diamonds)
diamond=data.frame(diamonds,na.rm=TRUE)
lm1=lm(price~carat+depth+table+x+y+z+cut+color+clarity,data=diamond,na.rm=TRUE)
lm2=lm(price~., data=diamond[-c(2,3,4)])
summary(lm2)
summary(lm1)
steplm1=step(lm1)
summary(steplm1)
par(mfrow=c(2,2))
plot(steplm1)
dfp=predict(steplm1,interval="prediction")
head(dfp,100)
# big memory required
mdf=merge(diamond$price,dfp)
mdf2=merge(head(diamond$price,1000),head(dfp,1000))
head(mdf2)
head(mdf2,100)
line(mdf2$x)
mdf2=matrix(mdf2,ncol=5,byrow = T)
mdf2=matrix(mdf2,ncol=4,byrow = T)
mdf2=matrix(mdf2,ncol=4,byrow = T)
mdf2
head(mdf2,100)
matplot(mdf2[,1],mdf2[,2:4],type="l",lwd=1,xlab="x",ylab="y")
matplot(mdf2[,1],mdf2[,2:4],type="l",lwd=1)
mdf2=merge(head(diamond$price,1000),head(dfp,1000))
plot(mdf2[,1],mdf2[,2:4],type="l",lwd=1)
plot(mdf2[,1],mdf2[,2:5],type="l",lwd=1)
plot(mdf2[,1],mdf2[,2:4],type="l",lwd=1)
mdf2
head(mdf2)
head(mdf2[,1])
head(mdf2[1,])
mdf3=matrix(mdf2,ncol=9,byrow = TRUE)
mdf3=matrix(mdf2,ncol=4,byrow = TRUE)
head(mdf3)
plot(mdf3[,1],mdf2[,2:4],type="l",lwd=1)
plot(mdf2[,0],mdf2[,2:4],type="l",lwd=1)
head(mdf2[,1])
head(mdf2[,0])
head(mdf2[1,])
[1:1000000]
mdf2$id=c[1:1000000]
id=c[1:1000000]
id=c[1:1000000]
id=(1:100)
id=(1:1000000)
cbind(mdf2,id)
head(mdf2)
rbind(mdf2,id)
rbind(mdf2,id)
function (..., deparse.level = 1)
cbind(mdf2,id)
head(mdf2)
mdf2=cbind(mdf2,id)
head(mdf2)
plot(mdf2[,5],mdf2[,1:4],type="l",lwd=1)
head(mdf2)
tail(mdf2)
tail(mdf2)
lenghth(mdf2[,5])
length(mdf2[,5])
length(mdf2[1:4])
plot(mdf2[,5],mdf2$[,1:4],type="l",lwd=1)
plot(mdf2[,5],mdf2$x,type="l",lwd=1)
plot((1:1000000),mdf2$x,type="l",lwd=1)
plot((1:1000000),mdf2$x,type="l",lwd=1)
matplot((1:1000000),mdf2$x,type="l",lwd=1)
matplot((1:1000000),mdf2$fit,type="l",lwd=1)
matplot((1:1000000),mdf2$lwr,type="l",lwd=1)
line((1:1000000),mdf2$fit,type="l",lwd=1)
line((1:1000000),mdf2$x,type="l",lwd=1)
line((1:1000000),mdf2$x)
matplot(c(1:1000000),mdf2[,2:4],type="l",lwd=1,xlab="x",ylab="y")
line((1:1000000),mdf2$x)
matplot(c(1:1000000),mdf2[,1:4],type="l",lwd=1,xlab="x",ylab="y")
colnames(mdf2)=paste(c("x",1:5))
matplot(c(1:1000000),mdf2[,1:4],col=c(1:6,8:9),type="l",lwd=1,xlab="x",ylab="y")
legend("20,3000000",colnames(mdf2)[-1],col=c(1:6,8:9),lwd=1)
colnames(mdf2)=paste(c("x",1:5))
colnames(mdf2)=paste(c("x",1:5))
legend("20,3000000",colnames(mdf2)[-1],col=c(1:6,8:9),lwd=1)
matplot(c(1:1000000),mdf2[,1:4],col=c(1:6,8:9),type="l",lwd=1,xlab="x",ylab="y")
matplot(c(1:1000000),mdf2[,1:4],col=c(1:6,8:9),type="l",lwd=1,xlab="x",ylab="y")
source('C:/Users/yzm/Desktop/Diamond.R', echo=TRUE)
matplot(c(1:1000000),mdf2[,1:4],col=c(1:6,8:9),type="l",lwd=1,xlab="x",ylab="y")
matplot(c(1:1000000),mdf2[,1:4],col=c(1:6,8:9),type="l",lwd=1,xlab="x",ylab="y")
plot(c(1:1000000),mdf2[,1:4],col=c(1:6,8:9),type="l",lwd=1,xlab="x",ylab="y")
plot(c(1:1000000),mdf2[,1:4],col=c(1:6,8:9),type="l",lwd=1,xlab="x",ylab="y")
matplot(c(1:1000000),mdf2[,1:4],type="l",lwd=1,xlab="x",ylab="y")
,col=c(1:6,8:9)
matplot(c(1:1000000),mdf2[,2:4],type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
matplot(c(1:1000000),mdf2[,1:4],type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
tail(mdf2)
matplot(c(1:1000000),mdf2[,1:4],type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
line((1:1000000),mdf2$x)
abline((1:1000000),mdf2$x)
matplot(c(1:1000000),mdf2[,1:4],type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
plot(c(1:1000000),mdf2[,1:4],type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
plot(c(1:100000),mdf2[,1:4],type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
plot(c(1:100000),head(mdf2[,1:4],100000),type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
plot(c(1:100000),head(mdf2[,1:4],100000),type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
View(mdf2)
View(mdf2)
View(mdf2)
View(mdf2)
View(mdf2)
View(mdf2)
View(mdf2)
plot(c(1:1000000),mdf2[,1:4],,type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
library(ggplot2)
library(car)
head(diamonds)
diamond=data.frame(diamonds,na.rm=TRUE)
lm1=lm(price~carat+depth+table+x+y+z+cut+color+clarity,data=diamond,na.rm=TRUE)
steplm1=step(lm1)
steplm1=step(lm1)
summary(steplm1)
par(mfrow=c(2,2))
plot(steplm1)
dfp=predict(steplm1,interval="prediction")
head(dfp,100)
# big memory required
#mdf=merge(diamond$price,dfp)
mdf2=merge(head(diamond$price,1000),head(dfp,1000))
id=(1:1000000)
mdf2=cbind(mdf2,id)
tail(mdf2)
length(mdf2[1:4])
plot(c(1:1000000),mdf2[,1:4],type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
plot(c(1:1000000),mdf2[,1:4],type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
abline((1:1000000),mdf2$x)
plot(c(1:1000000),mdf2$x,type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
plot(c(1:1000000),mdf2$x,type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
plot(c(1:1000000),mdf2$fit,type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
plot(c(1:1000000),mdf2$fit,type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
abline((1:1000000),mdf2$x)
plot(c(1:1000000),mdf2$fit,type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
plot(c(1:1000000),mdf2$fit,type="l",lwd=1,col=c(1:6,8:9),xlab="x",ylab="y")
library(ggplot2)
library(tree)
library(randomForest)
rf1=randomForest(price~., head(diamond,50),importance=TRUE,proximity=TRUE)
pre6=predict(rf1,diamond)
table(pre6,diamond$price)
table=table(pre6,diamond$price)
sum(diag(table)/sum(table))
model.forest.all <-randomForest(price ~ ., data = diamond,importance=TRUE,proximity=TRUE)
importance(model.forest.all)
varImpPlot(model.forest.all)
model.forest.all <-randomForest(price ~ ., data =  head(diamond,50),importance=TRUE,proximity=TRUE)
importance(model.forest.all)
varI
model.forest.all <-randomForest(price ~ ., data =  head(diamond,50),importance=TRUE,proximity=TRUE)
importance(model.forest.all)
varImpPlot(model.forest.all)
model.forest.all <-randomForest(price ~ ., data =  head(diamond,5000),importance=TRUE,proximity=TRUE)
importance(model.forest.all)
varImpPlot(model.forest.all)
library(party)
install.packages("party")
library(party)
myFormula=price~carat+depth+table+x+y+z+cut+color+clarity.
diamond_ctree=ctree(myFormula,data=diamond)
myFormula=price~carat+depth+table+x+y+z+cut+color+clarity
myFormula=price~carat+depth+table+x+y+z+cut+color+clarity
diamond_ctree=ctree(myFormula,data=diamond)
table(predict(diamond_ctree),diamond$price)
myFormula=price~carat+depth+table+x+y+z+cut+color+clarity
diamond_ctree=ctree(myFormula,data=head(diamond,20))
table(predict(diamond_ctree),diamond$price)
myFormula=price~carat+depth+table+x+y+z+cut+color+clarity
diamond_ctree=ctree(myFormula,data=head(diamond,20))
table(predict(diamond_ctree),diamond$price)
table(predict(diamond_ctree),head(diamond$price,20))
print(diamond_ctree)
plot(diamond_ctree)
plot(diamond_ctree,type="simple")
rpart_tree=rpart(myFormula,data=diamond)
library(rpart)
rpart_tree=rpart(myFormula,data=diamond)
rpart_tree=rpart(myFormula,data=diamond,control = rpart.control(minsplit = 10))
plot(rpart_tree)
text(rpart_tree,all=TRUE)
rf2 <- randomForest(price ~ ., data=diamond, ntree=100, proximity=TRUE)
table(predict(rf2), diamond$price)
rf2 <- randomForest(price ~ ., data=head(diamond,100), ntree=100, proximity=TRUE)
table(predict(rf2), diamond$price)
rf2 <- randomForest(price ~ ., data=head(diamond,100), ntree=100, proximity=TRUE)
table(predict(rf2), head(diamond$price,100))
rf1=randomForest(price~., head(diamond,50),importance=TRUE,proximity=TRUE)
pre6=predict(rf1,diamond)
matplot(diamond$price,type="l")
points(pre6,type="l",col=2)
rf1=randomForest(price~., head(diamond,500),importance=TRUE,proximity=TRUE)
pre6=predict(rf1,diamond)
matplot(diamond$price,type="l")
points(pre6,type="l",col=2)
rf1=randomForest(price~., head(diamond,1000),importance=TRUE,proximity=TRUE)
pre6=predict(rf1,diamond)
matplot(diamond$price,type="l")
points(pre6,type="l",col=2)
rf1=randomForest(price~., head(diamond,3000),importance=TRUE,proximity=TRUE)
pre6=predict(rf1,diamond)
matplot(diamond$price,type="l")
points(pre6,type="l",col=3)
rf1=randomForest(price~., tail(diamond,3000),importance=TRUE,proximity=TRUE)
pre6=predict(rf1,diamond)
matplot(diamond$price,type="l")
points(pre6,type="l",col=3)
rf1=randomForest(price~., tail(diamond,30000),importance=TRUE,proximity=TRUE)
pre6=predict(rf1,diamond)
matplot(diamond$price,type="l")
points(pre6,type="l",col=3)
plot(diamond$price,type="l")
points(pre6,type="l",col=3)
plot(diamond$price,type="l")
plot(head(diamond$price),type="l")
plot(head(diamond$price,100),type="l")
plot(head(diamond$price,1000),type="l")
plot(head(diamond$price,10000),type="l")
View(diamond)
View(diamond)
plot(head(diamond$price,100),type="l")
plot(head(diamond$price,200),type="l")
plot(head(diamond$price,300),type="l")
plot(head(diamond$price,400),type="l")
plot(head(diamond$price,430),type="l")
sort(diamond$price)
View(diamond)
diamond=diamond[order(diamond[,7])]
diamond[order(diamond[,7])]
diamond=data.frame(diamonds)
diamond[order(diamond[,7])]
diamond[order(diamond[,7]),]
diamond[sort(diamond[,7]),]
diamond=data.frame(diamonds)
diamond[sort(diamond[,7]),]
lm2=lm(price~carat+depth+table+x+y+z+cut+color,data=diamond)
steplm2=step(lm2)
price.predict=predict(steplm2,diamond)
matplot(diamond$price,type="l")
points(price.predict,type="l",col=2)
matplot(diamond$price,type="l")
View(diamond)
diamond=diamond[sort(diamond[,7]),]
diamond=data.frame(diamonds)
diamond=diamond[sort(diamond[,7]),]
lm2=lm(price~carat+depth+table+x+y+z+cut+color,data=diamond)
steplm2=step(lm2)
summary(steplm2)
price.predict=predict(steplm2,diamond)
matplot(diamond$price,type="l")
points(price.predict,type="l",col=2)
tmax2=tree(price~.,data=diamond)
plot(tmax2)
text(tmax2,all=TRUE)
set.seed(1234)
tcv=cv.tree(tmax2)
plot(tcv)
tmax3=prune.tree(tmax2,k=2e+10)
plot(tmax3)
text(tmax3,all=TRUE)
pre4=predict(tmax2,diamond)
glm2=glm(price~.,data=diamond)
glm3=step(glm2,diamond)
pre5=predict(glm3,diamond,type = "response")
matplot(diamond$price,type="l")
points(pre5,type="l",col=2)
matplot(diamond$price,type="l")
points(pre4,type="l",col=3)
rf1=randomForest(price~., tail(diamond,30000),importance=TRUE,proximity=TRUE)
pre6=predict(rf1,diamond)
plot(head(diamond$price,430),type="l")
points(pre6,type="l",col=3)
rf1=randomForest(price~., diamond,importance=TRUE,proximity=TRUE)
plot(head(diamond$price,50),type="l")
plot(head(diamond$price,500),type="l")
View(diamond)
View(diamond)
View(diamond)
diamond2=data.frame(diamonds)
diamond=diamond2[sort(diamond2[,7]),]
View(diamond2)
View(diamond2)
diamond=data.frame(diamonds)[sort(data.frame(diamonds)[,7]),]
matplot(diamond$price,type="l")
?predict
library(sqldf)
library(haven)
dataset <- read_stata(NULL)
View(dataset)
load("C:/Users/yzm/Desktop/.RData")
View(diamondsbig)
new_data=sqldf("select price from diamondbig where price is null")
head(diamondbig)
View(diamondsbig)
head(as.data.frame(diamondsbig))
diamondbig=as.data.frame(diamondbig)
as.data.frame(diamondsbig)
new_data=sqldf("select price from diamondbig where price is null")
as.data.frame(diamondsbig,na.rm=TRUE)
library(sqldf)
BD=as.data.frame(diamondsbig,na.rm=TRUE)
view(head(BD,100))
View(head(BD,100))
BD=na.omit(BD,TRUE)
new_data=sqldf("select price from BD where price is null")
new_data=sqldf("select count(* from DB where cert=GIA)")
new_data=sqldf("select count(* from DB where cert='GIA')")
new_data=sqldf("select count(*) from DB where cert='GIA'")
new_data=sqldf("select count(*) from BD where cert='GIA'")
new_data
new_data=sqldf("select count(*) from BD groupby cert ")
new_data=sqldf("select count(*) from BD group by cert ")
new_data
new_data=sqldf("select cert,count(*) from BD group by cert ")
new_data
